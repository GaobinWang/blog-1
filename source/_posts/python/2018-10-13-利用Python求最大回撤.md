
---
title: 利用Python求最大回撤
date: 2018-010-13 16:05:46
tags: [python]
mathjax: true
---


在进行基金评价时，最大回撤是我们常用的一个评价指标，利用随机数生成基金的净值序列，并给出Python中计算基金最大回撤的方法。
首先，我们模拟生成若干只基金的净值序列。


```python
###导入用到的Python库
import numpy as np
import pandas as pd

###生成模拟数据
FundNum = 5
Days = 20
DailyReturn = np.random.normal(0,1,(Days,FundNum))
Datetime = pd.date_range(start = "20180101",freq='D',periods = Days)

FundDailyReturn = pd.DataFrame(DailyReturn,index = Datetime,columns = ['FundId'+str(i+1) for i in range(FundNum)])
FundDailyNetValue = FundDailyReturn.apply(lambda x:1+x/100 ,axis =0)
FundNetValue = FundDailyNetValue.apply(np.cumprod)
```

基金的净值序列如下图表所示：


```python
print(FundNetValue)
FundNetValue.plot()
```

                 FundId1   FundId2   FundId3   FundId4   FundId5
    2018-01-01  0.998219  1.005502  0.994420  0.986963  0.994566
    2018-01-02  0.994973  1.012016  0.998481  0.994503  0.992566
    2018-01-03  0.999511  1.017042  0.986585  1.001931  0.975172
    2018-01-04  1.009966  1.025187  0.989050  1.002336  0.964044
    2018-01-05  1.004902  1.014491  0.986939  1.010981  0.956556
    2018-01-06  0.999060  1.028456  0.985314  1.005161  0.939396
    2018-01-07  0.988831  1.021289  0.970417  1.004620  0.949372
    2018-01-08  0.990112  1.024587  0.953299  1.005186  0.957515
    2018-01-09  0.995848  1.020403  0.946856  1.002071  0.949812
    2018-01-10  0.999286  1.014212  0.951193  1.006381  0.939607
    2018-01-11  0.988339  1.028606  0.947508  0.993978  0.950134
    2018-01-12  0.982271  1.025407  0.945642  0.999184  0.933527
    2018-01-13  0.982618  1.022751  0.937141  1.009745  0.934466
    2018-01-14  0.990560  1.030870  0.925400  1.003381  0.934680
    2018-01-15  0.976309  1.034191  0.932761  1.015297  0.930314
    2018-01-16  0.970571  1.057162  0.943378  1.035074  0.922728
    2018-01-17  0.970635  1.053331  0.940664  1.033323  0.929226
    2018-01-18  0.976975  1.049156  0.949116  1.045126  0.925981
    2018-01-19  0.971836  1.055991  0.945469  1.039291  0.943774
    2018-01-20  0.966796  1.049998  0.958627  1.049346  0.956474
    




{% asset_img plot1.png Fund NetValue %}



对于以上基金计算其最大回撤的方法如下：


```python
###计算最大回撤
MaxDrown = FundNetValue.apply(lambda x:np.min(x/x.cummax()-1))
print(MaxDrown)
```

    FundId1   -0.042745
    FundId2   -0.013850
    FundId3   -0.073192
    FundId4   -0.016818
    FundId5   -0.072230
    dtype: float64
    


```python

```
